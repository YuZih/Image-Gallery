"use strict";(self["webpackChunkvue_gallery"]=self["webpackChunkvue_gallery"]||[]).push([[818],{1379:function(t,e,o){o.r(e),o.d(e,{default:function(){return d}});var s=function(){var t=this,e=t._self._c;return e("DefaultLayout",[e("main",{staticClass:"formCtn container my-4"},[e("form",{attrs:{role:"form"},on:{submit:function(e){return e.preventDefault(),e.stopPropagation(),t.handleSubmit.apply(null,arguments)}}},[e("h3",{staticClass:"container text-center"},[t._v("Add New Post")]),e("div",{staticClass:"row"},[e("label",{staticClass:"col-sm-2 col-form-label",attrs:{for:"inputTitle"}},[t._v("Title"),e("span",[t._v("*")])]),e("div",{staticClass:"field col-sm-10"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.formData.title,expression:"formData.title"}],staticClass:"form-control",attrs:{type:"text",id:"inputTitle",name:"title",placeholder:"Enter post title here"},domProps:{value:t.formData.title},on:{input:function(e){e.target.composing||t.$set(t.formData,"title",e.target.value)}}}),e("div",{directives:[{name:"show",rawName:"v-show",value:t.showErrorMsg&&!t.formData.title.trim(),expression:"showErrorMsg && !formData.title.trim()"}],staticClass:"errorMsg"},[t._v("Title is required.")])])]),e("div",{staticClass:"row"},[e("label",{staticClass:"col-sm-2 col-form-label",attrs:{for:"contentArea"}},[t._v("Content"),e("span",[t._v("*")])]),e("div",{staticClass:"field col-sm-10"},[e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.formData.content,expression:"formData.content"}],staticClass:"form-control",attrs:{id:"contentArea",name:"content",rows:"10",placeholder:"Enter what you want to share here"},domProps:{value:t.formData.content},on:{input:function(e){e.target.composing||t.$set(t.formData,"content",e.target.value)}}}),e("div",{directives:[{name:"show",rawName:"v-show",value:t.showErrorMsg&&!t.formData.content.trim(),expression:"showErrorMsg && !formData.content.trim()"}],staticClass:"errorMsg"},[t._v("Content is required.")])])]),e("div",{staticClass:"row"},[e("label",{staticClass:"col-sm-2 col-form-label",attrs:{for:"inputCover"}},[t._v("Cover Image"),e("span",[t._v("*")])]),e("div",{staticClass:"field col-sm-4"},[e("input",{ref:"fileInput",staticClass:"d-none",attrs:{type:"file",accept:"image/*",id:"inputCover",name:"cover"},on:{change:t.updateFileName}}),e("button",{staticClass:"chooseBtn form-control",attrs:{type:"button"},on:{click:t.triggerFileInput}},[t._v(t._s(t.fileName?"Reselect file":"Choose file"))]),e("div",{directives:[{name:"show",rawName:"v-show",value:t.showErrorMsg&&!t.fileName,expression:"showErrorMsg && !fileName"}],staticClass:"errorMsg"},[t._v("Cover image is required.")])]),e("div",{staticClass:"col-sm-6"},[e("input",{staticClass:"form-control",attrs:{type:"text",readonly:"",id:"fileNameInput",placeholder:"No file chosen"},domProps:{value:t.fileName}})]),t.coverPreviewURL?e("div",{staticClass:"coverCtn"},[e("div",{staticClass:"col-sm-10 offset-sm-2"},[e("img",{staticClass:"coverPreview",attrs:{src:t.coverPreviewURL,alt:"cover-preview"}})])]):t._e()]),e("div",{staticClass:"row"},[e("label",{staticClass:"col-sm-2 col-form-label",attrs:{for:"latitudeInput"}},[t._v("Location (optional)")]),e("div",{staticClass:"field col-sm-5"},[e("div",{staticClass:"input-group"},[e("span",{staticClass:"input-group-text",attrs:{id:"latitudeLabel"}},[t._v("Latitude")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.latInput,expression:"latInput"}],staticClass:"form-control",attrs:{id:"latitudeInput",type:"text",placeholder:"Enter latitude here","aria-label":"latitudeTitle","aria-describedby":"latitudeLabel"},domProps:{value:t.latInput},on:{input:function(e){e.target.composing||(t.latInput=e.target.value)}}})])]),e("div",{staticClass:"field col-sm-5"},[e("div",{staticClass:"input-group"},[e("span",{staticClass:"input-group-text",attrs:{id:"longitudeLabel"}},[t._v("Longitude")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.lngInput,expression:"lngInput"}],staticClass:"form-control",attrs:{id:"longitudeInput",type:"text",placeholder:"Enter longitude here","aria-label":"longitudeTitle","aria-describedby":"longitudeLabel"},domProps:{value:t.lngInput},on:{input:function(e){e.target.composing||(t.lngInput=e.target.value)}}})])]),e("div",{staticClass:"col-sm-10 offset-2 mapNote"},[t._v(" *Please input coordinates or move the red marker to your photo location. ")]),t.formData.geopoint.lat&&t.formData.geopoint.lng?e("div",{staticClass:"col-sm-10 offset-2 mt-4"},[e("Map",{attrs:{center:t.formData.geopoint,initialMarker:{position:t.formData.geopoint}},on:{markerDragged:t.GeopointAfterDragged}})],1):e("div",{staticClass:"col-sm-10 offset-2 mt-4"},[e("Map",{on:{markerDragged:t.GeopointAfterDragged}})],1)]),e("div",{staticClass:"container text-center"},[e("button",{staticClass:"resetBtn",style:{cursor:t.isProcessing?"not-allowed":"pointer"},attrs:{type:"button",disabled:t.isProcessing},on:{click:t.handleReset}},[t._v(" Reset ")]),e("button",{staticClass:"postBtn",style:{cursor:t.isProcessing?"not-allowed":"pointer"},attrs:{type:"submit",disabled:t.isProcessing}},[t._v(" "+t._s(t.isProcessing?"Processing":"Post")+" ")])])])])])},a=[],i=(o(7658),o(3019)),r=o(408),l=o(3807),n=o(4094),c={name:"AdminAddView",components:{DefaultLayout:i.HQ,Map:i.D5},data(){return{mode:"add",isProcessing:!1,showErrorMsg:!1,fileChanged:!1,fileName:null,coverPreviewURL:null,latInput:null,lngInput:null,formData:{date:"",title:"",content:"",cover:"",album:"",geopoint:{lat:null,lng:null}}}},mounted(){if("adminEdit"===this.$route.name){this.mode="edit";const t=this.$route.params.id;this.$store.dispatch("toChangeFocusPostID",t)}},beforeRouteLeave(t,e,o){"adminAdd"!==t.name&&"adminEdit"!==t.name&&this.toChangeFocusPostID(""),o()},computed:{...(0,r.rn)(["postChanged"]),...(0,r.Se)(["albumsInOrder","postFilterByPostID"]),albumNames(){return Object.values(this.albumsInOrder).flat()}},watch:{postFilterByPostID(){"edit"===this.mode&&(console.log("postFilterByPostID: ",this.postFilterByPostID),this.formData.title=this.postFilterByPostID.title,this.formData.content=this.postFilterByPostID.content,this.formData.album=this.postFilterByPostID.album,this.formData.cover=this.postFilterByPostID.cover,this.coverPreviewURL=this.postFilterByPostID.cover,this.fileName="original post cover",this.postFilterByPostID.geopoint&&this.postFilterByPostID.geopoint.lat&&this.postFilterByPostID.geopoint.lng?(this.formData.geopoint=this.postFilterByPostID.geopoint,this.latInput=this.postFilterByPostID.geopoint.lat,this.lngInput=this.postFilterByPostID.geopoint.lng):(this.formData.geopoint={lat:null,lng:null},this.latInput=null,this.lngInput=null))},postChanged(){this.$router.push({name:"admin"})},latInput(t){let e=Number(t);this.formData.geopoint.lat=e},lngInput(t){let e=Number(t);this.formData.geopoint.lng=e},"formData.geopoint":{deep:!0,handler(t){this.latInput=t.lat,this.lngInput=t.lng}}},methods:{...(0,r.nv)(["toChangeFocusPostID","toAddPost","toUpdatePost"]),triggerFileInput(){this.$refs.fileInput.click()},updateFileName(t){const e=t.target.files[0];e&&(this.fileChanged=!0,this.fileName=e.name,this.coverPreviewURL=URL.createObjectURL(e),console.log(e),console.log(this.coverPreviewURL))},GeopointAfterDragged(t){this.formData.geopoint=t},handleReset(){this.$refs.fileInput.value="",this.isProcessing=!1,this.showErrorMsg=!1,this.fileName=null,this.coverPreviewURL=null,this.formData.date="",this.formData.title="",this.formData.content="",this.formData.album="",this.formData.geopoint=""},async handleSubmit(){if(this.formData.title.trim()&&this.formData.content.trim()&&this.fileName){if(this.isProcessing=!0,this.showErrorMsg=!1,this.fileChanged){const t=this.$refs.fileInput.files[0];if(t){const e=(0,l.iH)(n.t,"post-cover/"+t.name),o=(0,l.B0)(e,t),s=new Promise(((t,e)=>{o.on("state_changed",null,(t=>{console.log("Error uploading cover image: ",t),e(t)}),(()=>{(0,l.Jt)(o.snapshot.ref).then((e=>{this.formData.cover=e,console.log("File available at",e),t()}))}))}));await s}}this.formData.date=(new Date).getTime(),"edit"===this.mode?(console.log("toUpdatePost payload: ",this.formData),this.toUpdatePost({id:this.$route.params.id,newPost:this.formData})):(console.log("toAddPost payload: ",this.formData),this.toAddPost(this.formData))}else this.showErrorMsg=!0}}},m=c,p=o(1001),u=(0,p.Z)(m,s,a,!1,null,"402a4cec",null),d=u.exports}}]);
//# sourceMappingURL=adminAdd.21f18bd2.js.map